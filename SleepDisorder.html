<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

  <meta charset="utf-8">
  <meta name="generator" content="quarto-1.0.36">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


  <title>Sleep Disorder</title>
  <style>
    code {
      white-space: pre-wrap;
    }

    span.smallcaps {
      font-variant: small-caps;
    }

    span.underline {
      text-decoration: underline;
    }

    div.column {
      display: inline-block;
      vertical-align: top;
      width: 50%;
    }

    div.hanging-indent {
      margin-left: 1.5em;
      text-indent: -1.5em;
    }

    ul.task-list {
      list-style: none;
    }

    pre>code.sourceCode {
      white-space: pre;
      position: relative;
    }

    pre>code.sourceCode>span {
      display: inline-block;
      line-height: 1.25;
    }

    pre>code.sourceCode>span:empty {
      height: 1.2em;
    }

    .sourceCode {
      overflow: visible;
    }

    code.sourceCode>span {
      color: inherit;
      text-decoration: inherit;
    }

    div.sourceCode {
      margin: 1em 0;
    }

    pre.sourceCode {
      margin: 0;
    }

    @media screen {
      div.sourceCode {
        overflow: auto;
      }
    }

    @media print {
      pre>code.sourceCode {
        white-space: pre-wrap;
      }

      pre>code.sourceCode>span {
        text-indent: -5em;
        padding-left: 5em;
      }
    }

    pre.numberSource code {
      counter-reset: source-line 0;
    }

    pre.numberSource code>span {
      position: relative;
      left: -4em;
      counter-increment: source-line;
    }

    pre.numberSource code>span>a:first-child::before {
      content: counter(source-line);
      position: relative;
      left: -1em;
      text-align: right;
      vertical-align: baseline;
      border: none;
      display: inline-block;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      padding: 0 4px;
      width: 4em;
      color: #aaaaaa;
    }

    pre.numberSource {
      margin-left: 3em;
      border-left: 1px solid #aaaaaa;
      padding-left: 4px;
    }

    div.sourceCode {}

    @media screen {
      pre>code.sourceCode>span>a:first-child::before {
        text-decoration: underline;
      }
    }

    code span.al {
      color: #ff0000;
      font-weight: bold;
    }

    /* Alert */
    code span.an {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    /* Annotation */
    code span.at {
      color: #7d9029;
    }

    /* Attribute */
    code span.bn {
      color: #40a070;
    }

    /* BaseN */
    code span.bu {}

    /* BuiltIn */
    code span.cf {
      color: #007020;
      font-weight: bold;
    }

    /* ControlFlow */
    code span.ch {
      color: #4070a0;
    }

    /* Char */
    code span.cn {
      color: #880000;
    }

    /* Constant */
    code span.co {
      color: #60a0b0;
      font-style: italic;
    }

    /* Comment */
    code span.cv {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    /* CommentVar */
    code span.do {
      color: #ba2121;
      font-style: italic;
    }

    /* Documentation */
    code span.dt {
      color: #902000;
    }

    /* DataType */
    code span.dv {
      color: #40a070;
    }

    /* DecVal */
    code span.er {
      color: #ff0000;
      font-weight: bold;
    }

    /* Error */
    code span.ex {}

    /* Extension */
    code span.fl {
      color: #40a070;
    }

    /* Float */
    code span.fu {
      color: #06287e;
    }

    /* Function */
    code span.im {}

    /* Import */
    code span.in {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    /* Information */
    code span.kw {
      color: #007020;
      font-weight: bold;
    }

    /* Keyword */
    code span.op {
      color: #666666;
    }

    /* Operator */
    code span.ot {
      color: #007020;
    }

    /* Other */
    code span.pp {
      color: #bc7a00;
    }

    /* Preprocessor */
    code span.sc {
      color: #4070a0;
    }

    /* SpecialChar */
    code span.ss {
      color: #bb6688;
    }

    /* SpecialString */
    code span.st {
      color: #4070a0;
    }

    /* String */
    code span.va {
      color: #19177c;
    }

    /* Variable */
    code span.vs {
      color: #4070a0;
    }

    /* VerbatimString */
    code span.wa {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    /* Warning */
  </style>


  <script src="SleepDisorder_files/libs/clipboard/clipboard.min.js"></script>
  <script src="SleepDisorder_files/libs/quarto-html/quarto.js"></script>
  <script src="SleepDisorder_files/libs/quarto-html/popper.min.js"></script>
  <script src="SleepDisorder_files/libs/quarto-html/tippy.umd.min.js"></script>
  <script src="SleepDisorder_files/libs/quarto-html/anchor.min.js"></script>
  <link href="SleepDisorder_files/libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="SleepDisorder_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet"
    id="quarto-text-highlighting-styles">
  <script src="SleepDisorder_files/libs/bootstrap/bootstrap.min.js"></script>
  <link href="SleepDisorder_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="SleepDisorder_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap"
    data-mode="light">


</head>

<body class="fullcontent">

  <div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

    <main class="content" id="quarto-document-content">

      <header id="title-block-header" class="quarto-title-block default">
        <div class="quarto-title">
          <h1 class="title">Sleep Disorder</h1>
        </div>



        <div class="quarto-title-meta">



        </div>


      </header>

      <section id="sleep-health-and-lifestyle-analysis-project" class="level2">
        <h2 class="anchored" data-anchor-id="sleep-health-and-lifestyle-analysis-project">Sleep Health and Lifestyle
          Analysis Project</h2>
        <p>By:</p>
        <ol type="1">
          <li>
            <p>Amabel Nabila (455854)</p>
            <ul>
              <li>Data Visualization and Analysis</li>
            </ul>
          </li>
          <li>
            <p>Mustafa Ceyhun Vural (455158)</p>
            <ul>
              <li>Machine Learning</li>
            </ul>
          </li>
          <li>
            <p>Onur Durmus (455860)</p>
            <ul>
              <li>Machine Learning</li>
            </ul>
          </li>
          <li>
            <p>Zehra Usta (455847)</p>
            <ul>
              <li>Data Visualization and Analysis</li>
            </ul>
          </li>
        </ol>
      </section>
      <section id="project-objective" class="level2">
        <h2 class="anchored" data-anchor-id="project-objective">Project Objective</h2>
        <p>This project serves as the final assignment for the Reproducible Research course. It utilizes a dataset
          sourced from Kaggle and involves translating the code from Python to R. The aim of this project is to analyze
          the sleep health of individuals based on their respective lifestyles. Variables in this project include:</p>
        <ul>
          <li>
            <p>Gender</p>
          </li>
          <li>
            <p>Age</p>
          </li>
          <li>
            <p>Occupation</p>
          </li>
          <li>
            <p>Sleep Duration</p>
          </li>
          <li>
            <p>Quality of Sleep</p>
          </li>
          <li>
            <p>Physical Activity Level</p>
          </li>
          <li>
            <p>Stress Level</p>
          </li>
          <li>
            <p>BMI Category</p>
          </li>
          <li>
            <p>Blood Pressure</p>
          </li>
          <li>
            <p>Heart Rate</p>
          </li>
          <li>
            <p>Daily Steps</p>
          </li>
          <li>
            <p>Sleep Disorder</p>
          </li>
        </ul>
      </section>
      <section id="introduction" class="level2">
        <h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
        <p>Sleep disorders (or sleep-wake disorders) are difficulties with the quality, timing, and quantity of sleep
          that cause daily discomfort and impairment in functioning. Sleep-wake disturbances are frequently associated
          with physical or mental health illnesses such as depression, anxiety, or cognitive difficulties. There are
          various forms of sleep-wake disorders, with insomnia being the most frequent. Other sleep-wake problems
          include sleep apnea. Insomnia is a common sleep problem that makes it difficult to get asleep and remain
          asleep. Meanwhile, sleep apnea is a condition in which you stop breathing while asleep.</p>
      </section>
      <section id="library" class="level2">
        <h2 class="anchored" data-anchor-id="library">Library</h2>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb1">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries used</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>
Attaching package: 'dplyr'</code></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb5">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>Warning: package 'patchwork' was built under R version 4.3.3</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb7">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>corrplot 0.92 loaded</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb9">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>Warning: package 'ggExtra' was built under R version 4.3.3</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb11">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gbm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>Warning: package 'gbm' was built under R version 4.3.3</code></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>Loaded gbm 2.1.9</code></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>This version of gbm is no longer under development. Consider transitioning to gbm3, https://github.com/gbm-developers/gbm3</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb15">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>Warning: package 'caret' was built under R version 4.3.3</code></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>Loading required package: lattice</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb18">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caTools)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>Warning: package 'caTools' was built under R version 4.3.3</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb20">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
        </div>
      </section>
      <section id="data" class="level2">
        <h2 class="anchored" data-anchor-id="data">Data</h2>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb21">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'Sleep_health_and_lifestyle_dataset.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
        </div>
      </section>
      <section id="data-cleaning" class="level2">
        <h2 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h2>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb22">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop NA (if existed)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize "Normal Weight" and "normal" to "Normal" in "BMI Category"</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BMI.Category =</span> <span class="fu">ifelse</span>(BMI.Category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Normal Weight"</span>, <span class="st">"normal"</span>), <span class="st">"Normal"</span>, BMI.Category))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># View data cleaned</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>    Person.ID Gender Age           Occupation Sleep.Duration Quality.of.Sleep
1           1   Male  27    Software Engineer            6.1                6
2           2   Male  28               Doctor            6.2                6
3           3   Male  28               Doctor            6.2                6
4           4   Male  28 Sales Representative            5.9                4
5           5   Male  28 Sales Representative            5.9                4
6           6   Male  28    Software Engineer            5.9                4
7           7   Male  29              Teacher            6.3                6
8           8   Male  29               Doctor            7.8                7
9           9   Male  29               Doctor            7.8                7
10         10   Male  29               Doctor            7.8                7
11         11   Male  29               Doctor            6.1                6
12         12   Male  29               Doctor            7.8                7
13         13   Male  29               Doctor            6.1                6
14         14   Male  29               Doctor            6.0                6
15         15   Male  29               Doctor            6.0                6
16         16   Male  29               Doctor            6.0                6
17         17 Female  29                Nurse            6.5                5
18         18   Male  29               Doctor            6.0                6
19         19 Female  29                Nurse            6.5                5
20         20   Male  30               Doctor            7.6                7
21         21   Male  30               Doctor            7.7                7
22         22   Male  30               Doctor            7.7                7
23         23   Male  30               Doctor            7.7                7
24         24   Male  30               Doctor            7.7                7
25         25   Male  30               Doctor            7.8                7
26         26   Male  30               Doctor            7.9                7
27         27   Male  30               Doctor            7.8                7
28         28   Male  30               Doctor            7.9                7
29         29   Male  30               Doctor            7.9                7
30         30   Male  30               Doctor            7.9                7
31         31 Female  30                Nurse            6.4                5
32         32 Female  30                Nurse            6.4                5
33         33 Female  31                Nurse            7.9                8
34         34   Male  31               Doctor            6.1                6
35         35   Male  31               Doctor            7.7                7
36         36   Male  31               Doctor            6.1                6
37         37   Male  31               Doctor            6.1                6
38         38   Male  31               Doctor            7.6                7
39         39   Male  31               Doctor            7.6                7
40         40   Male  31               Doctor            7.6                7
41         41   Male  31               Doctor            7.7                7
42         42   Male  31               Doctor            7.7                7
43         43   Male  31               Doctor            7.7                7
44         44   Male  31               Doctor            7.8                7
45         45   Male  31               Doctor            7.7                7
46         46   Male  31               Doctor            7.8                7
47         47   Male  31               Doctor            7.7                7
48         48   Male  31               Doctor            7.8                7
49         49   Male  31               Doctor            7.7                7
50         50   Male  31               Doctor            7.7                7
51         51   Male  32             Engineer            7.5                8
52         52   Male  32             Engineer            7.5                8
53         53   Male  32               Doctor            6.0                6
54         54   Male  32               Doctor            7.6                7
55         55   Male  32               Doctor            6.0                6
56         56   Male  32               Doctor            6.0                6
57         57   Male  32               Doctor            7.7                7
58         58   Male  32               Doctor            6.0                6
59         59   Male  32               Doctor            6.0                6
60         60   Male  32               Doctor            7.7                7
61         61   Male  32               Doctor            6.0                6
62         62   Male  32               Doctor            6.0                6
63         63   Male  32               Doctor            6.2                6
64         64   Male  32               Doctor            6.2                6
65         65   Male  32               Doctor            6.2                6
66         66   Male  32               Doctor            6.2                6
67         67   Male  32           Accountant            7.2                8
68         68   Male  33               Doctor            6.0                6
69         69 Female  33            Scientist            6.2                6
70         70 Female  33            Scientist            6.2                6
71         71   Male  33               Doctor            6.1                6
72         72   Male  33               Doctor            6.1                6
73         73   Male  33               Doctor            6.1                6
74         74   Male  33               Doctor            6.1                6
75         75   Male  33               Doctor            6.0                6
76         76   Male  33               Doctor            6.0                6
77         77   Male  33               Doctor            6.0                6
78         78   Male  33               Doctor            6.0                6
79         79   Male  33               Doctor            6.0                6
80         80   Male  33               Doctor            6.0                6
81         81 Female  34            Scientist            5.8                4
82         82 Female  34            Scientist            5.8                4
83         83   Male  35              Teacher            6.7                7
84         84   Male  35              Teacher            6.7                7
85         85   Male  35    Software Engineer            7.5                8
86         86 Female  35           Accountant            7.2                8
87         87   Male  35             Engineer            7.2                8
88         88   Male  35             Engineer            7.2                8
89         89   Male  35             Engineer            7.3                8
90         90   Male  35             Engineer            7.3                8
91         91   Male  35             Engineer            7.3                8
92         92   Male  35             Engineer            7.3                8
93         93   Male  35    Software Engineer            7.5                8
94         94   Male  35               Lawyer            7.4                7
95         95 Female  36           Accountant            7.2                8
96         96 Female  36           Accountant            7.1                8
97         97 Female  36           Accountant            7.2                8
98         98 Female  36           Accountant            7.1                8
99         99 Female  36              Teacher            7.1                8
100       100 Female  36              Teacher            7.1                8
101       101 Female  36              Teacher            7.2                8
102       102 Female  36              Teacher            7.2                8
103       103 Female  36              Teacher            7.2                8
104       104   Male  36              Teacher            6.6                5
105       105 Female  36              Teacher            7.2                8
106       106   Male  36              Teacher            6.6                5
107       107 Female  37                Nurse            6.1                6
108       108   Male  37             Engineer            7.8                8
109       109   Male  37             Engineer            7.8                8
110       110   Male  37               Lawyer            7.4                8
111       111 Female  37           Accountant            7.2                8
112       112   Male  37               Lawyer            7.4                8
113       113 Female  37           Accountant            7.2                8
114       114   Male  37               Lawyer            7.4                8
115       115 Female  37           Accountant            7.2                8
116       116 Female  37           Accountant            7.2                8
117       117 Female  37           Accountant            7.2                8
118       118 Female  37           Accountant            7.2                8
119       119 Female  37           Accountant            7.2                8
120       120 Female  37           Accountant            7.2                8
121       121 Female  37           Accountant            7.2                8
122       122 Female  37           Accountant            7.2                8
123       123 Female  37           Accountant            7.2                8
124       124 Female  37           Accountant            7.2                8
125       125 Female  37           Accountant            7.2                8
126       126 Female  37                Nurse            7.5                8
127       127   Male  38               Lawyer            7.3                8
128       128 Female  38           Accountant            7.1                8
129       129   Male  38               Lawyer            7.3                8
130       130   Male  38               Lawyer            7.3                8
131       131 Female  38           Accountant            7.1                8
132       132   Male  38               Lawyer            7.3                8
133       133   Male  38               Lawyer            7.3                8
134       134 Female  38           Accountant            7.1                8
135       135   Male  38               Lawyer            7.3                8
136       136   Male  38               Lawyer            7.3                8
137       137 Female  38           Accountant            7.1                8
138       138   Male  38               Lawyer            7.1                8
139       139 Female  38           Accountant            7.1                8
140       140   Male  38               Lawyer            7.1                8
141       141 Female  38           Accountant            7.1                8
142       142   Male  38               Lawyer            7.1                8
143       143 Female  38           Accountant            7.1                8
144       144 Female  38           Accountant            7.1                8
145       145   Male  38               Lawyer            7.1                8
146       146 Female  38               Lawyer            7.4                7
147       147   Male  39               Lawyer            7.2                8
148       148   Male  39             Engineer            6.5                5
149       149 Female  39               Lawyer            6.9                7
150       150 Female  39           Accountant            8.0                9
151       151 Female  39           Accountant            8.0                9
152       152   Male  39               Lawyer            7.2                8
153       153   Male  39               Lawyer            7.2                8
154       154   Male  39               Lawyer            7.2                8
155       155   Male  39               Lawyer            7.2                8
156       156   Male  39               Lawyer            7.2                8
157       157   Male  39               Lawyer            7.2                8
158       158   Male  39               Lawyer            7.2                8
159       159   Male  39               Lawyer            7.2                8
160       160   Male  39               Lawyer            7.2                8
161       161   Male  39               Lawyer            7.2                8
162       162 Female  40           Accountant            7.2                8
163       163 Female  40           Accountant            7.2                8
164       164   Male  40               Lawyer            7.9                8
165       165   Male  40               Lawyer            7.9                8
166       166   Male  41               Lawyer            7.6                8
167       167   Male  41             Engineer            7.3                8
168       168   Male  41               Lawyer            7.1                7
169       169   Male  41               Lawyer            7.1                7
170       170   Male  41               Lawyer            7.7                8
171       171   Male  41               Lawyer            7.7                8
172       172   Male  41               Lawyer            7.7                8
173       173   Male  41               Lawyer            7.7                8
174       174   Male  41               Lawyer            7.7                8
175       175   Male  41               Lawyer            7.6                8
176       176   Male  41               Lawyer            7.6                8
177       177   Male  41               Lawyer            7.6                8
178       178   Male  42          Salesperson            6.5                6
179       179   Male  42               Lawyer            7.8                8
180       180   Male  42               Lawyer            7.8                8
181       181   Male  42               Lawyer            7.8                8
182       182   Male  42               Lawyer            7.8                8
183       183   Male  42               Lawyer            7.8                8
184       184   Male  42               Lawyer            7.8                8
185       185 Female  42              Teacher            6.8                6
186       186 Female  42              Teacher            6.8                6
187       187 Female  43              Teacher            6.7                7
188       188   Male  43          Salesperson            6.3                6
189       189 Female  43              Teacher            6.7                7
190       190   Male  43          Salesperson            6.5                6
191       191 Female  43              Teacher            6.7                7
192       192   Male  43          Salesperson            6.4                6
193       193   Male  43          Salesperson            6.5                6
194       194   Male  43          Salesperson            6.5                6
195       195   Male  43          Salesperson            6.5                6
196       196   Male  43          Salesperson            6.5                6
197       197   Male  43          Salesperson            6.5                6
198       198   Male  43          Salesperson            6.5                6
199       199   Male  43          Salesperson            6.5                6
200       200   Male  43          Salesperson            6.5                6
201       201   Male  43          Salesperson            6.5                6
202       202   Male  43             Engineer            7.8                8
203       203   Male  43             Engineer            7.8                8
204       204   Male  43             Engineer            6.9                6
205       205   Male  43             Engineer            7.6                8
206       206   Male  43             Engineer            7.7                8
207       207   Male  43             Engineer            7.7                8
208       208   Male  43             Engineer            7.7                8
209       209   Male  43             Engineer            7.7                8
210       210   Male  43             Engineer            7.8                8
211       211   Male  43             Engineer            7.7                8
212       212   Male  43             Engineer            7.8                8
213       213   Male  43             Engineer            7.8                8
214       214   Male  43             Engineer            7.8                8
215       215   Male  43             Engineer            7.8                8
216       216   Male  43             Engineer            7.8                8
217       217   Male  43             Engineer            7.8                8
218       218   Male  43             Engineer            7.8                8
219       219   Male  43             Engineer            7.8                8
220       220   Male  43          Salesperson            6.5                6
221       221 Female  44              Teacher            6.6                7
222       222   Male  44          Salesperson            6.4                6
223       223   Male  44          Salesperson            6.3                6
224       224   Male  44          Salesperson            6.4                6
225       225 Female  44              Teacher            6.6                7
226       226   Male  44          Salesperson            6.3                6
227       227 Female  44              Teacher            6.6                7
228       228   Male  44          Salesperson            6.3                6
229       229 Female  44              Teacher            6.6                7
230       230   Male  44          Salesperson            6.3                6
231       231 Female  44              Teacher            6.6                7
232       232   Male  44          Salesperson            6.3                6
233       233 Female  44              Teacher            6.6                7
234       234   Male  44          Salesperson            6.3                6
235       235 Female  44              Teacher            6.6                7
236       236   Male  44          Salesperson            6.3                6
237       237   Male  44          Salesperson            6.4                6
238       238 Female  44              Teacher            6.5                7
239       239   Male  44          Salesperson            6.3                6
240       240   Male  44          Salesperson            6.4                6
241       241 Female  44              Teacher            6.5                7
242       242   Male  44          Salesperson            6.3                6
243       243   Male  44          Salesperson            6.4                6
244       244 Female  44              Teacher            6.5                7
245       245   Male  44          Salesperson            6.3                6
246       246 Female  44              Teacher            6.5                7
247       247   Male  44          Salesperson            6.3                6
248       248   Male  44             Engineer            6.8                7
249       249   Male  44          Salesperson            6.4                6
250       250   Male  44          Salesperson            6.5                6
251       251 Female  45              Teacher            6.8                7
252       252 Female  45              Teacher            6.8                7
253       253 Female  45              Teacher            6.5                7
254       254 Female  45              Teacher            6.5                7
255       255 Female  45              Teacher            6.5                7
256       256 Female  45              Teacher            6.5                7
257       257 Female  45              Teacher            6.6                7
258       258 Female  45              Teacher            6.6                7
259       259 Female  45              Teacher            6.6                7
260       260 Female  45              Teacher            6.6                7
261       261 Female  45              Teacher            6.6                7
262       262 Female  45              Teacher            6.6                7
263       263 Female  45              Teacher            6.6                7
264       264 Female  45              Manager            6.9                7
265       265   Male  48               Doctor            7.3                7
266       266 Female  48                Nurse            5.9                6
267       267   Male  48               Doctor            7.3                7
268       268 Female  49                Nurse            6.2                6
269       269 Female  49                Nurse            6.0                6
270       270 Female  49                Nurse            6.1                6
271       271 Female  49                Nurse            6.1                6
272       272 Female  49                Nurse            6.1                6
273       273 Female  49                Nurse            6.1                6
274       274 Female  49                Nurse            6.2                6
275       275 Female  49                Nurse            6.2                6
276       276 Female  49                Nurse            6.2                6
277       277   Male  49               Doctor            8.1                9
278       278   Male  49               Doctor            8.1                9
279       279 Female  50                Nurse            6.1                6
280       280 Female  50             Engineer            8.3                9
281       281 Female  50                Nurse            6.0                6
282       282 Female  50                Nurse            6.1                6
283       283 Female  50                Nurse            6.0                6
284       284 Female  50                Nurse            6.0                6
285       285 Female  50                Nurse            6.0                6
286       286 Female  50                Nurse            6.0                6
287       287 Female  50                Nurse            6.0                6
288       288 Female  50                Nurse            6.0                6
289       289 Female  50                Nurse            6.0                6
290       290 Female  50                Nurse            6.1                6
291       291 Female  50                Nurse            6.0                6
292       292 Female  50                Nurse            6.1                6
293       293 Female  50                Nurse            6.1                6
294       294 Female  50                Nurse            6.0                6
295       295 Female  50                Nurse            6.1                6
296       296 Female  50                Nurse            6.0                6
297       297 Female  50                Nurse            6.1                6
298       298 Female  50                Nurse            6.1                6
299       299 Female  51             Engineer            8.5                9
300       300 Female  51             Engineer            8.5                9
301       301 Female  51             Engineer            8.5                9
302       302 Female  51             Engineer            8.5                9
303       303 Female  51                Nurse            7.1                7
304       304 Female  51                Nurse            6.0                6
305       305 Female  51                Nurse            6.1                6
306       306 Female  51                Nurse            6.1                6
307       307 Female  52           Accountant            6.5                7
308       308 Female  52           Accountant            6.5                7
309       309 Female  52           Accountant            6.6                7
310       310 Female  52           Accountant            6.6                7
311       311 Female  52           Accountant            6.6                7
312       312 Female  52           Accountant            6.6                7
313       313 Female  52             Engineer            8.4                9
314       314 Female  52             Engineer            8.4                9
315       315 Female  52             Engineer            8.4                9
316       316 Female  53             Engineer            8.3                9
317       317 Female  53             Engineer            8.5                9
318       318 Female  53             Engineer            8.5                9
319       319 Female  53             Engineer            8.4                9
320       320 Female  53             Engineer            8.4                9
321       321 Female  53             Engineer            8.5                9
322       322 Female  53             Engineer            8.4                9
323       323 Female  53             Engineer            8.4                9
324       324 Female  53             Engineer            8.5                9
325       325 Female  53             Engineer            8.3                9
326       326 Female  53             Engineer            8.5                9
327       327 Female  53             Engineer            8.3                9
328       328 Female  53             Engineer            8.5                9
329       329 Female  53             Engineer            8.3                9
330       330 Female  53             Engineer            8.5                9
331       331 Female  53             Engineer            8.5                9
332       332 Female  53             Engineer            8.4                9
333       333 Female  54             Engineer            8.4                9
334       334 Female  54             Engineer            8.4                9
335       335 Female  54             Engineer            8.4                9
336       336 Female  54             Engineer            8.4                9
337       337 Female  54             Engineer            8.4                9
338       338 Female  54             Engineer            8.4                9
339       339 Female  54             Engineer            8.5                9
340       340 Female  55                Nurse            8.1                9
341       341 Female  55                Nurse            8.1                9
342       342 Female  56               Doctor            8.2                9
343       343 Female  56               Doctor            8.2                9
344       344 Female  57                Nurse            8.1                9
345       345 Female  57                Nurse            8.2                9
346       346 Female  57                Nurse            8.2                9
347       347 Female  57                Nurse            8.2                9
348       348 Female  57                Nurse            8.2                9
349       349 Female  57                Nurse            8.2                9
350       350 Female  57                Nurse            8.1                9
351       351 Female  57                Nurse            8.1                9
352       352 Female  57                Nurse            8.1                9
353       353 Female  58                Nurse            8.0                9
354       354 Female  58                Nurse            8.0                9
355       355 Female  58                Nurse            8.0                9
356       356 Female  58                Nurse            8.0                9
357       357 Female  58                Nurse            8.0                9
358       358 Female  58                Nurse            8.0                9
359       359 Female  59                Nurse            8.0                9
360       360 Female  59                Nurse            8.1                9
361       361 Female  59                Nurse            8.2                9
362       362 Female  59                Nurse            8.2                9
363       363 Female  59                Nurse            8.2                9
364       364 Female  59                Nurse            8.2                9
365       365 Female  59                Nurse            8.0                9
366       366 Female  59                Nurse            8.0                9
367       367 Female  59                Nurse            8.1                9
368       368 Female  59                Nurse            8.0                9
369       369 Female  59                Nurse            8.1                9
370       370 Female  59                Nurse            8.1                9
371       371 Female  59                Nurse            8.0                9
372       372 Female  59                Nurse            8.1                9
373       373 Female  59                Nurse            8.1                9
374       374 Female  59                Nurse            8.1                9
    Physical.Activity.Level Stress.Level BMI.Category Blood.Pressure Heart.Rate
1                        42            6   Overweight         126/83         77
2                        60            8       Normal         125/80         75
3                        60            8       Normal         125/80         75
4                        30            8        Obese         140/90         85
5                        30            8        Obese         140/90         85
6                        30            8        Obese         140/90         85
7                        40            7        Obese         140/90         82
8                        75            6       Normal         120/80         70
9                        75            6       Normal         120/80         70
10                       75            6       Normal         120/80         70
11                       30            8       Normal         120/80         70
12                       75            6       Normal         120/80         70
13                       30            8       Normal         120/80         70
14                       30            8       Normal         120/80         70
15                       30            8       Normal         120/80         70
16                       30            8       Normal         120/80         70
17                       40            7       Normal         132/87         80
18                       30            8       Normal         120/80         70
19                       40            7       Normal         132/87         80
20                       75            6       Normal         120/80         70
21                       75            6       Normal         120/80         70
22                       75            6       Normal         120/80         70
23                       75            6       Normal         120/80         70
24                       75            6       Normal         120/80         70
25                       75            6       Normal         120/80         70
26                       75            6       Normal         120/80         70
27                       75            6       Normal         120/80         70
28                       75            6       Normal         120/80         70
29                       75            6       Normal         120/80         70
30                       75            6       Normal         120/80         70
31                       35            7       Normal         130/86         78
32                       35            7       Normal         130/86         78
33                       75            4       Normal         117/76         69
34                       30            8       Normal         125/80         72
35                       75            6       Normal         120/80         70
36                       30            8       Normal         125/80         72
37                       30            8       Normal         125/80         72
38                       75            6       Normal         120/80         70
39                       75            6       Normal         120/80         70
40                       75            6       Normal         120/80         70
41                       75            6       Normal         120/80         70
42                       75            6       Normal         120/80         70
43                       75            6       Normal         120/80         70
44                       75            6       Normal         120/80         70
45                       75            6       Normal         120/80         70
46                       75            6       Normal         120/80         70
47                       75            6       Normal         120/80         70
48                       75            6       Normal         120/80         70
49                       75            6       Normal         120/80         70
50                       75            6       Normal         120/80         70
51                       45            3       Normal         120/80         70
52                       45            3       Normal         120/80         70
53                       30            8       Normal         125/80         72
54                       75            6       Normal         120/80         70
55                       30            8       Normal         125/80         72
56                       30            8       Normal         125/80         72
57                       75            6       Normal         120/80         70
58                       30            8       Normal         125/80         72
59                       30            8       Normal         125/80         72
60                       75            6       Normal         120/80         70
61                       30            8       Normal         125/80         72
62                       30            8       Normal         125/80         72
63                       30            8       Normal         125/80         72
64                       30            8       Normal         125/80         72
65                       30            8       Normal         125/80         72
66                       30            8       Normal         125/80         72
67                       50            6       Normal         118/76         68
68                       30            8       Normal         125/80         72
69                       50            6   Overweight         128/85         76
70                       50            6   Overweight         128/85         76
71                       30            8       Normal         125/80         72
72                       30            8       Normal         125/80         72
73                       30            8       Normal         125/80         72
74                       30            8       Normal         125/80         72
75                       30            8       Normal         125/80         72
76                       30            8       Normal         125/80         72
77                       30            8       Normal         125/80         72
78                       30            8       Normal         125/80         72
79                       30            8       Normal         125/80         72
80                       30            8       Normal         125/80         72
81                       32            8   Overweight         131/86         81
82                       32            8   Overweight         131/86         81
83                       40            5   Overweight         128/84         70
84                       40            5   Overweight         128/84         70
85                       60            5       Normal         120/80         70
86                       60            4       Normal         115/75         68
87                       60            4       Normal         125/80         65
88                       60            4       Normal         125/80         65
89                       60            4       Normal         125/80         65
90                       60            4       Normal         125/80         65
91                       60            4       Normal         125/80         65
92                       60            4       Normal         125/80         65
93                       60            5       Normal         120/80         70
94                       60            5        Obese         135/88         84
95                       60            4       Normal         115/75         68
96                       60            4       Normal         115/75         68
97                       60            4       Normal         115/75         68
98                       60            4       Normal         115/75         68
99                       60            4       Normal         115/75         68
100                      60            4       Normal         115/75         68
101                      60            4       Normal         115/75         68
102                      60            4       Normal         115/75         68
103                      60            4       Normal         115/75         68
104                      35            7   Overweight         129/84         74
105                      60            4       Normal         115/75         68
106                      35            7   Overweight         129/84         74
107                      42            6   Overweight         126/83         77
108                      70            4       Normal         120/80         68
109                      70            4       Normal         120/80         68
110                      60            5       Normal         130/85         68
111                      60            4       Normal         115/75         68
112                      60            5       Normal         130/85         68
113                      60            4       Normal         115/75         68
114                      60            5       Normal         130/85         68
115                      60            4       Normal         115/75         68
116                      60            4       Normal         115/75         68
117                      60            4       Normal         115/75         68
118                      60            4       Normal         115/75         68
119                      60            4       Normal         115/75         68
120                      60            4       Normal         115/75         68
121                      60            4       Normal         115/75         68
122                      60            4       Normal         115/75         68
123                      60            4       Normal         115/75         68
124                      60            4       Normal         115/75         68
125                      60            4       Normal         115/75         68
126                      60            4       Normal         120/80         70
127                      60            5       Normal         130/85         68
128                      60            4       Normal         115/75         68
129                      60            5       Normal         130/85         68
130                      60            5       Normal         130/85         68
131                      60            4       Normal         115/75         68
132                      60            5       Normal         130/85         68
133                      60            5       Normal         130/85         68
134                      60            4       Normal         115/75         68
135                      60            5       Normal         130/85         68
136                      60            5       Normal         130/85         68
137                      60            4       Normal         115/75         68
138                      60            5       Normal         130/85         68
139                      60            4       Normal         115/75         68
140                      60            5       Normal         130/85         68
141                      60            4       Normal         115/75         68
142                      60            5       Normal         130/85         68
143                      60            4       Normal         115/75         68
144                      60            4       Normal         115/75         68
145                      60            5       Normal         130/85         68
146                      60            5        Obese         135/88         84
147                      60            5       Normal         130/85         68
148                      40            7   Overweight         132/87         80
149                      50            6       Normal         128/85         75
150                      80            3       Normal         115/78         67
151                      80            3       Normal         115/78         67
152                      60            5       Normal         130/85         68
153                      60            5       Normal         130/85         68
154                      60            5       Normal         130/85         68
155                      60            5       Normal         130/85         68
156                      60            5       Normal         130/85         68
157                      60            5       Normal         130/85         68
158                      60            5       Normal         130/85         68
159                      60            5       Normal         130/85         68
160                      60            5       Normal         130/85         68
161                      60            5       Normal         130/85         68
162                      55            6       Normal         119/77         73
163                      55            6       Normal         119/77         73
164                      90            5       Normal         130/85         68
165                      90            5       Normal         130/85         68
166                      90            5       Normal         130/85         70
167                      70            6       Normal         121/79         72
168                      55            6   Overweight         125/82         72
169                      55            6   Overweight         125/82         72
170                      90            5       Normal         130/85         70
171                      90            5       Normal         130/85         70
172                      90            5       Normal         130/85         70
173                      90            5       Normal         130/85         70
174                      90            5       Normal         130/85         70
175                      90            5       Normal         130/85         70
176                      90            5       Normal         130/85         70
177                      90            5       Normal         130/85         70
178                      45            7   Overweight         130/85         72
179                      90            5       Normal         130/85         70
180                      90            5       Normal         130/85         70
181                      90            5       Normal         130/85         70
182                      90            5       Normal         130/85         70
183                      90            5       Normal         130/85         70
184                      90            5       Normal         130/85         70
185                      45            7   Overweight         130/85         78
186                      45            7   Overweight         130/85         78
187                      45            4   Overweight         135/90         65
188                      45            7   Overweight         130/85         72
189                      45            4   Overweight         135/90         65
190                      45            7   Overweight         130/85         72
191                      45            4   Overweight         135/90         65
192                      45            7   Overweight         130/85         72
193                      45            7   Overweight         130/85         72
194                      45            7   Overweight         130/85         72
195                      45            7   Overweight         130/85         72
196                      45            7   Overweight         130/85         72
197                      45            7   Overweight         130/85         72
198                      45            7   Overweight         130/85         72
199                      45            7   Overweight         130/85         72
200                      45            7   Overweight         130/85         72
201                      45            7   Overweight         130/85         72
202                      90            5       Normal         130/85         70
203                      90            5       Normal         130/85         70
204                      47            7       Normal         117/76         69
205                      75            4   Overweight         122/80         68
206                      90            5       Normal         130/85         70
207                      90            5       Normal         130/85         70
208                      90            5       Normal         130/85         70
209                      90            5       Normal         130/85         70
210                      90            5       Normal         130/85         70
211                      90            5       Normal         130/85         70
212                      90            5       Normal         130/85         70
213                      90            5       Normal         130/85         70
214                      90            5       Normal         130/85         70
215                      90            5       Normal         130/85         70
216                      90            5       Normal         130/85         70
217                      90            5       Normal         130/85         70
218                      90            5       Normal         130/85         70
219                      90            5       Normal         130/85         70
220                      45            7   Overweight         130/85         72
221                      45            4   Overweight         135/90         65
222                      45            7   Overweight         130/85         72
223                      45            7   Overweight         130/85         72
224                      45            7   Overweight         130/85         72
225                      45            4   Overweight         135/90         65
226                      45            7   Overweight         130/85         72
227                      45            4   Overweight         135/90         65
228                      45            7   Overweight         130/85         72
229                      45            4   Overweight         135/90         65
230                      45            7   Overweight         130/85         72
231                      45            4   Overweight         135/90         65
232                      45            7   Overweight         130/85         72
233                      45            4   Overweight         135/90         65
234                      45            7   Overweight         130/85         72
235                      45            4   Overweight         135/90         65
236                      45            7   Overweight         130/85         72
237                      45            7   Overweight         130/85         72
238                      45            4   Overweight         135/90         65
239                      45            7   Overweight         130/85         72
240                      45            7   Overweight         130/85         72
241                      45            4   Overweight         135/90         65
242                      45            7   Overweight         130/85         72
243                      45            7   Overweight         130/85         72
244                      45            4   Overweight         135/90         65
245                      45            7   Overweight         130/85         72
246                      45            4   Overweight         135/90         65
247                      45            7   Overweight         130/85         72
248                      45            7   Overweight         130/85         78
249                      45            7   Overweight         130/85         72
250                      45            7   Overweight         130/85         72
251                      30            6   Overweight         135/90         65
252                      30            6   Overweight         135/90         65
253                      45            4   Overweight         135/90         65
254                      45            4   Overweight         135/90         65
255                      45            4   Overweight         135/90         65
256                      45            4   Overweight         135/90         65
257                      45            4   Overweight         135/90         65
258                      45            4   Overweight         135/90         65
259                      45            4   Overweight         135/90         65
260                      45            4   Overweight         135/90         65
261                      45            4   Overweight         135/90         65
262                      45            4   Overweight         135/90         65
263                      45            4   Overweight         135/90         65
264                      55            5   Overweight         125/82         75
265                      65            5        Obese         142/92         83
266                      90            8   Overweight         140/95         75
267                      65            5        Obese         142/92         83
268                      90            8   Overweight         140/95         75
269                      90            8   Overweight         140/95         75
270                      90            8   Overweight         140/95         75
271                      90            8   Overweight         140/95         75
272                      90            8   Overweight         140/95         75
273                      90            8   Overweight         140/95         75
274                      90            8   Overweight         140/95         75
275                      90            8   Overweight         140/95         75
276                      90            8   Overweight         140/95         75
277                      85            3        Obese         139/91         86
278                      85            3        Obese         139/91         86
279                      90            8   Overweight         140/95         75
280                      30            3       Normal         125/80         65
281                      90            8   Overweight         140/95         75
282                      90            8   Overweight         140/95         75
283                      90            8   Overweight         140/95         75
284                      90            8   Overweight         140/95         75
285                      90            8   Overweight         140/95         75
286                      90            8   Overweight         140/95         75
287                      90            8   Overweight         140/95         75
288                      90            8   Overweight         140/95         75
289                      90            8   Overweight         140/95         75
290                      90            8   Overweight         140/95         75
291                      90            8   Overweight         140/95         75
292                      90            8   Overweight         140/95         75
293                      90            8   Overweight         140/95         75
294                      90            8   Overweight         140/95         75
295                      90            8   Overweight         140/95         75
296                      90            8   Overweight         140/95         75
297                      90            8   Overweight         140/95         75
298                      90            8   Overweight         140/95         75
299                      30            3       Normal         125/80         65
300                      30            3       Normal         125/80         65
301                      30            3       Normal         125/80         65
302                      30            3       Normal         125/80         65
303                      55            6       Normal         125/82         72
304                      90            8   Overweight         140/95         75
305                      90            8   Overweight         140/95         75
306                      90            8   Overweight         140/95         75
307                      45            7   Overweight         130/85         72
308                      45            7   Overweight         130/85         72
309                      45            7   Overweight         130/85         72
310                      45            7   Overweight         130/85         72
311                      45            7   Overweight         130/85         72
312                      45            7   Overweight         130/85         72
313                      30            3       Normal         125/80         65
314                      30            3       Normal         125/80         65
315                      30            3       Normal         125/80         65
316                      30            3       Normal         125/80         65
317                      30            3       Normal         125/80         65
318                      30            3       Normal         125/80         65
319                      30            3       Normal         125/80         65
320                      30            3       Normal         125/80         65
321                      30            3       Normal         125/80         65
322                      30            3       Normal         125/80         65
323                      30            3       Normal         125/80         65
324                      30            3       Normal         125/80         65
325                      30            3       Normal         125/80         65
326                      30            3       Normal         125/80         65
327                      30            3       Normal         125/80         65
328                      30            3       Normal         125/80         65
329                      30            3       Normal         125/80         65
330                      30            3       Normal         125/80         65
331                      30            3       Normal         125/80         65
332                      30            3       Normal         125/80         65
333                      30            3       Normal         125/80         65
334                      30            3       Normal         125/80         65
335                      30            3       Normal         125/80         65
336                      30            3       Normal         125/80         65
337                      30            3       Normal         125/80         65
338                      30            3       Normal         125/80         65
339                      30            3       Normal         125/80         65
340                      75            4   Overweight         140/95         72
341                      75            4   Overweight         140/95         72
342                      90            3       Normal         118/75         65
343                      90            3       Normal         118/75         65
344                      75            3   Overweight         140/95         68
345                      75            3   Overweight         140/95         68
346                      75            3   Overweight         140/95         68
347                      75            3   Overweight         140/95         68
348                      75            3   Overweight         140/95         68
349                      75            3   Overweight         140/95         68
350                      75            3   Overweight         140/95         68
351                      75            3   Overweight         140/95         68
352                      75            3   Overweight         140/95         68
353                      75            3   Overweight         140/95         68
354                      75            3   Overweight         140/95         68
355                      75            3   Overweight         140/95         68
356                      75            3   Overweight         140/95         68
357                      75            3   Overweight         140/95         68
358                      75            3   Overweight         140/95         68
359                      75            3   Overweight         140/95         68
360                      75            3   Overweight         140/95         68
361                      75            3   Overweight         140/95         68
362                      75            3   Overweight         140/95         68
363                      75            3   Overweight         140/95         68
364                      75            3   Overweight         140/95         68
365                      75            3   Overweight         140/95         68
366                      75            3   Overweight         140/95         68
367                      75            3   Overweight         140/95         68
368                      75            3   Overweight         140/95         68
369                      75            3   Overweight         140/95         68
370                      75            3   Overweight         140/95         68
371                      75            3   Overweight         140/95         68
372                      75            3   Overweight         140/95         68
373                      75            3   Overweight         140/95         68
374                      75            3   Overweight         140/95         68
    Daily.Steps Sleep.Disorder
1          4200           None
2         10000           None
3         10000           None
4          3000    Sleep Apnea
5          3000    Sleep Apnea
6          3000       Insomnia
7          3500       Insomnia
8          8000           None
9          8000           None
10         8000           None
11         8000           None
12         8000           None
13         8000           None
14         8000           None
15         8000           None
16         8000           None
17         4000    Sleep Apnea
18         8000    Sleep Apnea
19         4000       Insomnia
20         8000           None
21         8000           None
22         8000           None
23         8000           None
24         8000           None
25         8000           None
26         8000           None
27         8000           None
28         8000           None
29         8000           None
30         8000           None
31         4100    Sleep Apnea
32         4100       Insomnia
33         6800           None
34         5000           None
35         8000           None
36         5000           None
37         5000           None
38         8000           None
39         8000           None
40         8000           None
41         8000           None
42         8000           None
43         8000           None
44         8000           None
45         8000           None
46         8000           None
47         8000           None
48         8000           None
49         8000           None
50         8000    Sleep Apnea
51         8000           None
52         8000           None
53         5000           None
54         8000           None
55         5000           None
56         5000           None
57         8000           None
58         5000           None
59         5000           None
60         8000           None
61         5000           None
62         5000           None
63         5000           None
64         5000           None
65         5000           None
66         5000           None
67         7000           None
68         5000       Insomnia
69         5500           None
70         5500           None
71         5000           None
72         5000           None
73         5000           None
74         5000           None
75         5000           None
76         5000           None
77         5000           None
78         5000           None
79         5000           None
80         5000           None
81         5200    Sleep Apnea
82         5200    Sleep Apnea
83         5600           None
84         5600           None
85         8000           None
86         7000           None
87         5000           None
88         5000           None
89         5000           None
90         5000           None
91         5000           None
92         5000           None
93         8000           None
94         3300    Sleep Apnea
95         7000       Insomnia
96         7000           None
97         7000           None
98         7000           None
99         7000           None
100        7000           None
101        7000           None
102        7000           None
103        7000           None
104        4800    Sleep Apnea
105        7000    Sleep Apnea
106        4800       Insomnia
107        4200           None
108        7000           None
109        7000           None
110        8000           None
111        7000           None
112        8000           None
113        7000           None
114        8000           None
115        7000           None
116        7000           None
117        7000           None
118        7000           None
119        7000           None
120        7000           None
121        7000           None
122        7000           None
123        7000           None
124        7000           None
125        7000           None
126        8000           None
127        8000           None
128        7000           None
129        8000           None
130        8000           None
131        7000           None
132        8000           None
133        8000           None
134        7000           None
135        8000           None
136        8000           None
137        7000           None
138        8000           None
139        7000           None
140        8000           None
141        7000           None
142        8000           None
143        7000           None
144        7000           None
145        8000    Sleep Apnea
146        3300    Sleep Apnea
147        8000       Insomnia
148        4000       Insomnia
149        5500           None
150        7500           None
151        7500           None
152        8000           None
153        8000           None
154        8000           None
155        8000           None
156        8000           None
157        8000           None
158        8000           None
159        8000           None
160        8000           None
161        8000           None
162        7300           None
163        7300           None
164        8000           None
165        8000           None
166        8000       Insomnia
167        6200           None
168        6000           None
169        6000           None
170        8000           None
171        8000           None
172        8000           None
173        8000           None
174        8000           None
175        8000           None
176        8000           None
177        8000           None
178        6000       Insomnia
179        8000           None
180        8000           None
181        8000           None
182        8000           None
183        8000           None
184        8000           None
185        5000    Sleep Apnea
186        5000    Sleep Apnea
187        6000       Insomnia
188        6000       Insomnia
189        6000       Insomnia
190        6000       Insomnia
191        6000       Insomnia
192        6000       Insomnia
193        6000       Insomnia
194        6000       Insomnia
195        6000       Insomnia
196        6000       Insomnia
197        6000       Insomnia
198        6000       Insomnia
199        6000       Insomnia
200        6000       Insomnia
201        6000       Insomnia
202        8000       Insomnia
203        8000       Insomnia
204        6800           None
205        6800           None
206        8000           None
207        8000           None
208        8000           None
209        8000           None
210        8000           None
211        8000           None
212        8000           None
213        8000           None
214        8000           None
215        8000           None
216        8000           None
217        8000           None
218        8000           None
219        8000    Sleep Apnea
220        6000    Sleep Apnea
221        6000       Insomnia
222        6000       Insomnia
223        6000       Insomnia
224        6000       Insomnia
225        6000       Insomnia
226        6000       Insomnia
227        6000       Insomnia
228        6000       Insomnia
229        6000       Insomnia
230        6000       Insomnia
231        6000       Insomnia
232        6000       Insomnia
233        6000       Insomnia
234        6000       Insomnia
235        6000       Insomnia
236        6000       Insomnia
237        6000       Insomnia
238        6000       Insomnia
239        6000       Insomnia
240        6000       Insomnia
241        6000       Insomnia
242        6000       Insomnia
243        6000       Insomnia
244        6000       Insomnia
245        6000       Insomnia
246        6000       Insomnia
247        6000       Insomnia
248        5000       Insomnia
249        6000           None
250        6000           None
251        6000       Insomnia
252        6000       Insomnia
253        6000       Insomnia
254        6000       Insomnia
255        6000       Insomnia
256        6000       Insomnia
257        6000       Insomnia
258        6000       Insomnia
259        6000       Insomnia
260        6000       Insomnia
261        6000       Insomnia
262        6000           None
263        6000           None
264        5500           None
265        3500       Insomnia
266       10000    Sleep Apnea
267        3500       Insomnia
268       10000           None
269       10000    Sleep Apnea
270       10000    Sleep Apnea
271       10000    Sleep Apnea
272       10000    Sleep Apnea
273       10000    Sleep Apnea
274       10000    Sleep Apnea
275       10000    Sleep Apnea
276       10000    Sleep Apnea
277        3700    Sleep Apnea
278        3700    Sleep Apnea
279       10000       Insomnia
280        5000           None
281       10000           None
282       10000    Sleep Apnea
283       10000    Sleep Apnea
284       10000    Sleep Apnea
285       10000    Sleep Apnea
286       10000    Sleep Apnea
287       10000    Sleep Apnea
288       10000    Sleep Apnea
289       10000    Sleep Apnea
290       10000    Sleep Apnea
291       10000    Sleep Apnea
292       10000    Sleep Apnea
293       10000    Sleep Apnea
294       10000    Sleep Apnea
295       10000    Sleep Apnea
296       10000    Sleep Apnea
297       10000    Sleep Apnea
298       10000    Sleep Apnea
299        5000           None
300        5000           None
301        5000           None
302        5000           None
303        6000           None
304       10000    Sleep Apnea
305       10000    Sleep Apnea
306       10000    Sleep Apnea
307        6000       Insomnia
308        6000       Insomnia
309        6000       Insomnia
310        6000       Insomnia
311        6000       Insomnia
312        6000       Insomnia
313        5000           None
314        5000           None
315        5000           None
316        5000       Insomnia
317        5000           None
318        5000           None
319        5000           None
320        5000           None
321        5000           None
322        5000           None
323        5000           None
324        5000           None
325        5000           None
326        5000           None
327        5000           None
328        5000           None
329        5000           None
330        5000           None
331        5000           None
332        5000           None
333        5000           None
334        5000           None
335        5000           None
336        5000           None
337        5000           None
338        5000           None
339        5000           None
340        5000    Sleep Apnea
341        5000    Sleep Apnea
342       10000           None
343       10000           None
344        7000           None
345        7000    Sleep Apnea
346        7000    Sleep Apnea
347        7000    Sleep Apnea
348        7000    Sleep Apnea
349        7000    Sleep Apnea
350        7000    Sleep Apnea
351        7000    Sleep Apnea
352        7000    Sleep Apnea
353        7000    Sleep Apnea
354        7000    Sleep Apnea
355        7000    Sleep Apnea
356        7000    Sleep Apnea
357        7000    Sleep Apnea
358        7000    Sleep Apnea
359        7000           None
360        7000           None
361        7000    Sleep Apnea
362        7000    Sleep Apnea
363        7000    Sleep Apnea
364        7000    Sleep Apnea
365        7000    Sleep Apnea
366        7000    Sleep Apnea
367        7000    Sleep Apnea
368        7000    Sleep Apnea
369        7000    Sleep Apnea
370        7000    Sleep Apnea
371        7000    Sleep Apnea
372        7000    Sleep Apnea
373        7000    Sleep Apnea
374        7000    Sleep Apnea</code></pre>
          </div>
        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb24">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the Blood.Pressure column into two new columns and convert to numeric</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> Blood.Pressure, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"Systolic Pressure"</span>, <span class="st">"Diastolic Pressure"</span>), <span class="at">sep =</span> <span class="st">"/"</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Systolic Pressure</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Systolic Pressure</span><span class="st">`</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Diastolic Pressure</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Diastolic Pressure</span><span class="st">`</span>))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the structure of the updated data frame</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>'data.frame':   374 obs. of  14 variables:
 $ Person.ID              : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Gender                 : chr  "Male" "Male" "Male" "Male" ...
 $ Age                    : int  27 28 28 28 28 28 29 29 29 29 ...
 $ Occupation             : chr  "Software Engineer" "Doctor" "Doctor" "Sales Representative" ...
 $ Sleep.Duration         : num  6.1 6.2 6.2 5.9 5.9 5.9 6.3 7.8 7.8 7.8 ...
 $ Quality.of.Sleep       : int  6 6 6 4 4 4 6 7 7 7 ...
 $ Physical.Activity.Level: int  42 60 60 30 30 30 40 75 75 75 ...
 $ Stress.Level           : int  6 8 8 8 8 8 7 6 6 6 ...
 $ BMI.Category           : chr  "Overweight" "Normal" "Normal" "Obese" ...
 $ Systolic Pressure      : num  126 125 125 140 140 140 140 120 120 120 ...
 $ Diastolic Pressure     : num  83 80 80 90 90 90 90 80 80 80 ...
 $ Heart.Rate             : int  77 75 75 85 85 85 82 70 70 70 ...
 $ Daily.Steps            : int  4200 10000 10000 3000 3000 3000 3500 8000 8000 8000 ...
 $ Sleep.Disorder         : chr  "None" "None" "None" "Sleep Apnea" ...</code></pre>
          </div>
        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb26">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to categorize blood pressure</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>categorize_blood_pressure <span class="ot">&lt;-</span> <span class="cf">function</span>(systolic, diastolic) {</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(systolic) <span class="sc">|</span> <span class="fu">is.na</span>(diastolic)) {</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (systolic <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">&amp;</span> diastolic <span class="sc">&lt;</span> <span class="dv">80</span>) {</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">'Optimal'</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (systolic <span class="sc">&lt;=</span> <span class="dv">139</span> <span class="sc">|</span> diastolic <span class="sc">&lt;=</span> <span class="dv">89</span>) {</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">'Normal'</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (systolic <span class="sc">&gt;=</span> <span class="dv">140</span> <span class="sc">|</span> diastolic <span class="sc">&gt;=</span> <span class="dv">90</span>) {</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">'Hypertension'</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">'Other'</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the categorization function to create the Blood Pressure Category column</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Blood.Pressure.Category</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">categorize_blood_pressure</span>(<span class="st">`</span><span class="at">Systolic Pressure</span><span class="st">`</span>, <span class="st">`</span><span class="at">Diastolic Pressure</span><span class="st">`</span>))</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="co"># View the newest data</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code># A tibble: 374 × 15
# Rowwise: 
   Person.ID Gender   Age Occupation           Sleep.Duration Quality.of.Sleep
       &lt;int&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;                         &lt;dbl&gt;            &lt;int&gt;
 1         1 Male      27 Software Engineer               6.1                6
 2         2 Male      28 Doctor                          6.2                6
 3         3 Male      28 Doctor                          6.2                6
 4         4 Male      28 Sales Representative            5.9                4
 5         5 Male      28 Sales Representative            5.9                4
 6         6 Male      28 Software Engineer               5.9                4
 7         7 Male      29 Teacher                         6.3                6
 8         8 Male      29 Doctor                          7.8                7
 9         9 Male      29 Doctor                          7.8                7
10        10 Male      29 Doctor                          7.8                7
# ℹ 364 more rows
# ℹ 9 more variables: Physical.Activity.Level &lt;int&gt;, Stress.Level &lt;int&gt;,
#   BMI.Category &lt;chr&gt;, `Systolic Pressure` &lt;dbl&gt;, `Diastolic Pressure` &lt;dbl&gt;,
#   Heart.Rate &lt;int&gt;, Daily.Steps &lt;int&gt;, Sleep.Disorder &lt;chr&gt;,
#   Blood.Pressure.Category &lt;chr&gt;</code></pre>
          </div>
        </div>
      </section>
      <section id="data-visualization" class="level2">
        <h2 class="anchored" data-anchor-id="data-visualization">Data Visualization</h2>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb28">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a box plot for Age distribution</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>age_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> Age)) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age Distribution"</span>, <span class="at">y =</span> <span class="st">"Age"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram for Age distribution</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>age_histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Age)) <span class="sc">+</span> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age Distribution"</span>, <span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a box plot for Quality of Sleep distribution</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>quality_of_sleep_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> Quality.of.Sleep)) <span class="sc">+</span> </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quality of Sleep Distribution"</span>, <span class="at">y =</span> <span class="st">"Quality of Sleep"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram for Quality of Sleep distribution</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>quality_of_sleep_histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Quality.of.Sleep)) <span class="sc">+</span> </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quality of Sleep Distribution"</span>, <span class="at">x =</span> <span class="st">"Quality of Sleep"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a box plot for Physical Activity Level distribution</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>physical_activity_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> Physical.Activity.Level)) <span class="sc">+</span> </span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Physical Activity Level Distribution"</span>, <span class="at">y =</span> <span class="st">"Physical Activity Level"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram for Physical Activity Level distribution</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>physical_activity_histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Physical.Activity.Level)) <span class="sc">+</span> </span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Physical Activity Level Distribution"</span>, <span class="at">x =</span> <span class="st">"Physical Activity Level"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a box plot for Stress Level distribution</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>stress_level_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> Stress.Level)) <span class="sc">+</span> </span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Stress Level Distribution"</span>, <span class="at">y =</span> <span class="st">"Stress Level"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram for Stress Level distribution</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>stress_level_histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Stress.Level)) <span class="sc">+</span> </span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Stress Level Distribution"</span>, <span class="at">x =</span> <span class="st">"Stress Level"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a box plot for Heart Rate distribution</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>heart_rate_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> Heart.Rate)) <span class="sc">+</span> </span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Rate Distribution"</span>, <span class="at">y =</span> <span class="st">"Heart Rate"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram for Heart Rate distribution</span></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>heart_rate_histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Heart.Rate)) <span class="sc">+</span> </span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Rate Distribution"</span>, <span class="at">x =</span> <span class="st">"Heart Rate"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a box plot for Daily Steps distribution</span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>daily_steps_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> Daily.Steps)) <span class="sc">+</span> </span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Daily Steps Distribution"</span>, <span class="at">y =</span> <span class="st">"Daily Steps"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram for Daily Steps distribution</span></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>daily_steps_histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Daily.Steps)) <span class="sc">+</span> </span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">500</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Daily Steps Distribution"</span>, <span class="at">x =</span> <span class="st">"Daily Steps"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots into a single figure</span></span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>combined_plots <span class="ot">&lt;-</span> (age_boxplot <span class="sc">|</span> age_histogram) <span class="sc">/</span> </span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>  (quality_of_sleep_boxplot <span class="sc">|</span> quality_of_sleep_histogram) <span class="sc">/</span> </span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>  (physical_activity_boxplot <span class="sc">|</span> physical_activity_histogram) <span class="sc">/</span> </span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>  (stress_level_boxplot <span class="sc">|</span> stress_level_histogram) <span class="sc">/</span> </span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>  (heart_rate_boxplot <span class="sc">|</span> heart_rate_histogram) <span class="sc">/</span> </span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>  (daily_steps_boxplot <span class="sc">|</span> daily_steps_histogram) </span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the layout of the combined plot</span></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>combined_plot_layout <span class="ot">&lt;-</span> combined_plots <span class="sc">+</span> </span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot with the layout</span></span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot_layout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Age Distribution</strong>:</p>
        <p>The box plot indicates a fairly uniform age distribution, with a few outliers on the higher end. The
          histogram verifies this, displaying a fairly consistent distribution across age groups with a little rise in
          frequency at the middle age range.</p>
        <p><strong>Quality of Sleep Distribution</strong>:</p>
        <p>The box plot shows that most values are concentrated in the center of the scale, implying that the majority
          of people have intermediate sleep quality, with occasional outliers indicating very good sleep quality. The
          histogram confirms this, demonstrating that most people report sleep quality in the center of the scale, with
          fewer reporting extremely high or terrible sleep quality.</p>
        <p><strong>Physical Activity Level Distribution:</strong></p>
        <p>The box plot for physical activity levels shows a broad range of values, with outliers at both the low and
          high ends. The histogram has a bimodal distribution, with peaks at both the low and high ends of the activity
          scale. This might imply that there are two separate groups in the population: one that is less active and one
          that is more active.</p>
        <p><strong>Stress Level Distribution</strong>:</p>
        <p>According to the box plot, stress levels are typically close to the median, with no extreme outliers. The
          histogram shows a rather uniform distribution, with a tiny peak at higher stress levels.</p>
        <p><strong>Heart Rate Distribution:</strong></p>
        <p>The heart rate box plot displays a reasonably compact interquartile range, indicating that the majority of
          people have a resting heart rate within a restricted range, despite the presence of multiple outliers. The
          histogram shows a normal distribution with a peak at 70 beats per minute, which is typical for a resting heart
          rate in adults.</p>
        <p><strong>Daily Steps Distribution</strong>:</p>
        <p>The box plot depicts a wide distribution, reflecting variation in the number of daily steps across
          individuals, with a few outliers suggesting extremely high step counts. The histogram shows that the majority
          of people have a daily step count on the low end of the scale, with fewer people reaching higher step
          counts.<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb29">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean, median, and mode</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mean_sleep <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Quality.of.Sleep, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>median_sleep <span class="ot">&lt;-</span> <span class="fu">median</span>(data<span class="sc">$</span>Quality.of.Sleep, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>mode_sleep <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(data<span class="sc">$</span>Quality.of.Sleep), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>]))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the histogram and add lines for mean, median, and mode</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>quality_of_sleep_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Quality.of.Sleep)) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..count..), <span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> mean_sleep, <span class="at">color =</span> <span class="st">"Mean"</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> median_sleep, <span class="at">color =</span> <span class="st">"Median"</span>), <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> mode_sleep, <span class="at">color =</span> <span class="st">"Mode"</span>), <span class="at">linetype =</span> <span class="st">"dotdash"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Statistics"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Mean"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Median"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Mode"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quality of Sleep Distribution"</span>, <span class="at">x =</span> <span class="st">"Quality of Sleep"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>),</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">1.2</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plot</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(quality_of_sleep_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>Warning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(count)` instead.</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p>The majority of participants reported excellent quality of sleep (average scores of 7 and 8). The fact that
          the mode is higher than both the mean and the median indicates that, while some people may have poor sleep
          quality, this group is more likely to have good sleep.<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb31">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column names</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>quality_of_sleep_col <span class="ot">&lt;-</span> <span class="st">"Quality.of.Sleep"</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>grouping_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Occupation"</span>, <span class="st">"BMI.Category"</span>, <span class="st">"Blood.Pressure.Category"</span>, <span class="st">"Sleep.Disorder"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(grouping_col <span class="cf">in</span> grouping_cols) {</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if each group has at least two data points</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  valid_groups <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!</span><span class="fu">sym</span>(grouping_col)) <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="sc">!!</span><span class="fu">sym</span>(grouping_col)) <span class="sc">%&gt;%</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the density plot only for valid groups</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(valid_groups) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!!</span><span class="fu">sym</span>(grouping_col) <span class="sc">%in%</span> valid_groups), </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes_string</span>(<span class="at">x =</span> quality_of_sleep_col, <span class="at">fill =</span> grouping_col)) <span class="sc">+</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Quality of Sleep by"</span>, grouping_col))</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    plots[[grouping_col]] <span class="ot">&lt;-</span> p</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"Not enough data to plot"</span>, grouping_col))</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb33">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check your list of plots</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>$Gender</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>
$Occupation</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>
$BMI.Category</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid" width="672"></p>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>
$Blood.Pressure.Category</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid" width="672"></p>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>
$Sleep.Disorder</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-8-5.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb39">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To display the plots</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(plots) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(gridExtra)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(grid.arrange, <span class="fu">c</span>(plots, <span class="at">ncol =</span> <span class="dv">2</span>))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>
Attaching package: 'gridExtra'</code></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-8-6.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p>The investigation reveals that there are distinct patterns and variances in sleep quality based on gender,
          employment, BMI, blood pressure, and the prevalence of sleeping disorders. Lifestyle and health circumstances
          appear to have a substantial impact on sleep quality.<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb42">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot for Age by Gender</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>age_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">y =</span> Age, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"1. How old are they?"</span>, <span class="at">y =</span> <span class="st">"Age"</span>, <span class="at">x =</span> <span class="st">"Gender"</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot for Sleep Duration by Gender</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>sleep_duration_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">y =</span> <span class="st">`</span><span class="at">Sleep.Duration</span><span class="st">`</span>, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"2. How long do they sleep?"</span>, <span class="at">y =</span> <span class="st">"Sleep.Duration"</span>, <span class="at">x =</span> <span class="st">"Gender"</span>) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot for Quality of Sleep by Gender</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>quality_sleep_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">y =</span> <span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span>, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"3. How well do they sleep?"</span>, <span class="at">y =</span> <span class="st">"Quality of Sleep"</span>, <span class="at">x =</span> <span class="st">"Gender"</span>) <span class="sc">+</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots into a single plot window</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(age_plot, sleep_duration_plot, quality_sleep_plot, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Age:</strong></p>
        <p>The age boxplot suggests that, on average, women in this dataset are older than men, as indicated by the
          higher median line for women in the box. Comparable ranges for the top and bottom of the box and the
          interquartile range (IQR, the height of the box) point to similar age variability for both genders. There are
          men and females that are both younger and older than the core age categories, according to the whiskers, which
          depict the dispersion of the remaining data. However, the range for females is larger, indicating greater
          ages.</p>
        <p><strong>Sleep Duration:</strong></p>
        <p>The boxplot illustrates that men have a somewhat shorter median sleep time than women. The identical IQRs for
          the two genders suggest that the middle 50% of people have similar sleep duration distributions. Males appear
          to have a significantly larger distribution of sleep time than females, as indicated by the slightly greater
          range for males.</p>
        <p><strong>Quality of Sleep:</strong></p>
        <p>The median line suggests that when it comes to sleep quality, women appear to report a little greater median
          quality of sleep than men. For both genders, the dispersion of values (IQR) is comparable, though. Females
          tend to have a greater general range than males, suggesting that the quality of their sleep is more variable,
          with some reporting extremely good and some very low quality.</p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb43">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of participants in each occupation</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>occupation_count <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Occupation) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Participants =</span> <span class="fu">n_distinct</span>(Person.ID))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average quality of sleep for each occupation</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>avg_quality_of_sleep <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Occupation) <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AvgQualityOfSleep =</span> <span class="fu">mean</span>(Quality.of.Sleep, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of Participants by Occupation</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>occupation_count_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(occupation_count, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Occupation, <span class="sc">-</span>Participants), <span class="at">y =</span> Participants)) <span class="sc">+</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"1. What are their occupations?"</span>, <span class="at">x =</span> <span class="st">"Number of participants"</span>, <span class="at">y =</span> <span class="st">"Occupation"</span>) <span class="sc">+</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Average Quality of Sleep by Occupation</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>quality_sleep_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(avg_quality_of_sleep, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Occupation, AvgQualityOfSleep), <span class="at">y =</span> AvgQualityOfSleep)) <span class="sc">+</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"2. Who sleeps better, and who worse?"</span>, <span class="at">x =</span> <span class="st">"Avg Quality of Sleep"</span>, <span class="at">y =</span> <span class="st">"Occupation"</span>) <span class="sc">+</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plots</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(occupation_count_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb44">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(quality_sleep_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Occupational Distribution</strong>:</p>
        <p>The distribution of participants among different vocations is seen in the first chart. The most common
          occupation is nursing, which is followed by engineering and medicine. In the sample, managers and sales reps
          are the least represented. This distribution may represent the true demographic composition of the pool from
          which participants were selected, or it may show the interest or availability of various occupations in taking
          part in the study.<br>
        </p>
        <p><strong>Average Quality of Sleep by Occupation</strong>:</p>
        <p>The second graph displays the average sleep quality for various professions. Engineers seem to have the
          greatest average sleep quality, followed by accountants and attorneys. Conversely, scientists and sales people
          report the lowest average quality of sleep, which might be attributed to issues relating to their line of work
          or greater levels of stress related to their jobs. Despite the important importance of their work, doctors do
          not necessarily get better sleep than other professions, as seen by the fact that, despite their large
          representation in the dataset, their average sleep quality does not top the list.<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb45">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count of participants by Sleep Disorder</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>sleep_disorder_count <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Sleep.Disorder)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"1. How many suffer from Sleep Disorders?"</span>, <span class="at">x =</span> <span class="st">"Sleep Disorder"</span>, <span class="at">y =</span> <span class="st">"Number of Participants"</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Average Quality of Sleep by Sleep Disorder</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>avg_sleep_quality_by_disorder <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Sleep.Disorder, <span class="at">y =</span> Quality.of.Sleep)) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"2. Who sleeps better?"</span>, <span class="at">x =</span> <span class="st">"Sleep Disorder"</span>, <span class="at">y =</span> <span class="st">"Avg Sleep Quality"</span>) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sleep quality boxplot by Sleep Disorder</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>sleep_quality_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Sleep.Disorder, <span class="at">y =</span> Quality.of.Sleep)) <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"3. Sleep quality boxplot by Sleep Disorders"</span>, <span class="at">x =</span> <span class="st">"Sleep.Disorder"</span>, <span class="at">y =</span> <span class="st">"Sleep.Quality"</span>) <span class="sc">+</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plots</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sleep_disorder_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb46">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(avg_sleep_quality_by_disorder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb47">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sleep_quality_boxplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Prevalence of Sleep Disorders</strong>:</p>
        <p>The bar graph displays the number of individuals with various sleep problems. The majority of individuals do
          not appear to have a sleep issue, with insomnia being the most common and sleep apnea being the least
          prevalent.</p>
        <p><strong>Average Sleep Quality by Sleep Disorder</strong>:</p>
        <p>This bar graph shows that persons without a sleep issue had the highest average sleep quality score,
          indicating higher overall sleep quality. Individuals with insomnia and sleep apnea have lower scores,
          indicating worse sleep quality, which is consistent with the nature of these diseases.<br>
        </p>
        <p><strong>Sleep Quality Distribution by Sleep Disorder</strong>:</p>
        <p>The boxplot depicts the distribution of sleep quality across each sleep disorder category. Individuals
          without a sleep issue had the greatest median sleep quality. Participants with insomnia have the lowest median
          sleep quality and a larger interquartile range (IQR), indicating greater variability in their sleep quality.
          The ‘Sleep Apnea’ group has a greater median sleep quality than the ‘Insomnia’ group, but it also has a wide
          IQR, indicating variability among persons with this disease.<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb48">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI Data Plotting</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of participants in each BMI category</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>bmi_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(BMI.Category) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Number.of.Participants =</span> <span class="fu">n</span>())</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average quality of sleep for each BMI category</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>bmi_quality <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(BMI.Category) <span class="sc">%&gt;%</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg.Quality.of.Sleep =</span> <span class="fu">mean</span>(Quality.of.Sleep, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for BMI category participant count</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>bmi_count_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bmi_counts, <span class="fu">aes</span>(<span class="at">x =</span> BMI.Category, <span class="at">y =</span> Number.of.Participants, <span class="at">fill =</span> BMI.Category)) <span class="sc">+</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"1. What is your BMI category?"</span>, <span class="at">x =</span> <span class="st">"BMI Category"</span>, <span class="at">y =</span> <span class="st">"Number of participants"</span>) <span class="sc">+</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for average quality of sleep by BMI category</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>bmi_quality_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bmi_quality, <span class="fu">aes</span>(<span class="at">x =</span> BMI.Category, <span class="at">y =</span> Avg.Quality.of.Sleep, <span class="at">fill =</span> BMI.Category)) <span class="sc">+</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"2. Who sleeps better?"</span>, <span class="at">x =</span> <span class="st">"BMI Category"</span>, <span class="at">y =</span> <span class="st">"Avg Quality of Sleep"</span>) <span class="sc">+</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot for quality of sleep by BMI category</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>bmi_quality_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> BMI.Category, <span class="at">y =</span> Quality.of.Sleep, <span class="at">fill =</span> BMI.Category)) <span class="sc">+</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"3. Sleep quality boxplot by BMI Category"</span>, <span class="at">x =</span> <span class="st">"BMI Category"</span>, <span class="at">y =</span> <span class="st">"Quality of Sleep"</span>) <span class="sc">+</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plots</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>bmi_count_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb49">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>bmi_quality_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb50">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>bmi_quality_boxplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>BMI Category Distribution</strong>:</p>
        <p>The first graphic is a bar graph that depicts the distribution of participants across various BMI groups. The
          bulk of the participants had a ‘Normal’ BMI, with a much lower proportion in the ‘Overweight’ group and very
          few in the ‘Obese’ category.</p>
        <p><strong>Average Quality of Sleep by BMI Category</strong>:</p>
        <p>The second figure depicts the average sleep quality for each BMI group, as measured on a scale (not stated,
          but likely 1 to 10 or comparable). persons with a ‘Normal’ BMI report the best average quality of sleep,
          followed by ‘Overweight’ persons, who report somewhat less, and ‘Obese’ individuals, who report the lowest
          average quality of sleep. However, the differences across the groups appear to be small.</p>
        <p><strong>Sleep Quality Boxplot by BMI Category</strong>:</p>
        <p>The final graphic is a boxplot that shows a more comprehensive distribution of sleep quality ratings within
          each BMI group. The ‘Normal’ BMI group has the greatest median sleep quality but also includes an outlier with
          a very poor sleep quality score. The ‘Obese’ category has a broad interquartile range, indicating that sleep
          quality varies more among people in this group. The ‘Overweight’ category has a median sleep quality that is
          lower than the ‘Normal’ but higher than the ‘Obese’ category, and its interquartile range is shorter than in
          the ‘Obese’ group, indicating greater consistency in sleep quality among ‘Overweight’ individuals.<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb51">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Blood Pressure Data Plotting</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat the same process for blood pressure data</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>bp_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Blood.Pressure.Category) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Number.of.Participants =</span> <span class="fu">n</span>())</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>bp_quality <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Blood.Pressure.Category) <span class="sc">%&gt;%</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg.Quality.of.Sleep =</span> <span class="fu">mean</span>(Quality.of.Sleep, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>bp_count_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bp_counts, <span class="fu">aes</span>(<span class="at">x =</span> Blood.Pressure.Category, <span class="at">y =</span> Number.of.Participants, <span class="at">fill =</span> Blood.Pressure.Category)) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"1. How is your Blood Pressure level?"</span>, <span class="at">x =</span> <span class="st">"Blood Pressure Category"</span>, <span class="at">y =</span> <span class="st">"Number of participants"</span>) <span class="sc">+</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>bp_quality_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bp_quality, <span class="fu">aes</span>(<span class="at">x =</span> Blood.Pressure.Category, <span class="at">y =</span> Avg.Quality.of.Sleep, <span class="at">fill =</span> Blood.Pressure.Category)) <span class="sc">+</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"2. Who sleeps better?"</span>, <span class="at">x =</span> <span class="st">"Blood Pressure Category"</span>, <span class="at">y =</span> <span class="st">"Avg Quality of Sleep"</span>) <span class="sc">+</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>bp_quality_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Blood.Pressure.Category, <span class="at">y =</span> Quality.of.Sleep, <span class="at">fill =</span> Blood.Pressure.Category)) <span class="sc">+</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"3. Sleep Quality boxplot by Blood Pressure Category"</span>, <span class="at">x =</span> <span class="st">"Blood Pressure Category"</span>, <span class="at">y =</span> <span class="st">"Quality of Sleep"</span>) <span class="sc">+</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>bp_count_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb52">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>bp_quality_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb53">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>bp_quality_boxplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Blood Pressure Level Distribution</strong>:</p>
        <p>The bar chart depicts the distribution of blood pressure categories among the participants. The biggest group
          is those with normal blood pressure, followed by those with hypertension, and the smallest group is made up of
          people with ideal blood pressure. This shows that the majority of people have normal blood pressure.<br>
        </p>
        <p><strong>Average Sleep Quality by Blood Pressure Category</strong>:</p>
        <p>The bar chart that compares the average sleep quality of the same blood pressure groups. Interestingly,
          individuals with ideal blood pressure had the best average sleep quality, followed by those with normal blood
          pressure, and those with hypertension have the lowest average sleep quality. This suggests a possible link
          between reduced blood pressure and improved sleep quality.<br>
        </p>
        <p><strong>Sleep Quality Boxplot by Blood Pressure Category</strong>:</p>
        <p>The boxplot that shows how sleep quality varies across each blood pressure group. The boxplot for
          hypertension exhibits a broader range and higher median sleep quality scores than the boxplot for normal blood
          pressure, which is more compacted and has a little lower median. The ideal blood pressure group had a higher
          median than the other two, but a few outliers suggest that some people with perfect blood pressure
          nevertheless report poor sleep quality. This graph illustrates that, while people with ideal blood pressure
          had superior average sleep quality, there is variation within each category.<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb54">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only the numeric columns from the data</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="ot">&lt;-</span> data[<span class="fu">sapply</span>(data, is.numeric)]</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the correlation matrix</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(numeric_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the correlation heatmap</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">diag =</span> <span class="cn">FALSE</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <ul>
          <li>
            <p>The scale on the right represents the range of correlation coefficients from -1 to 1.</p>
          </li>
          <li>
            <p>A coefficient near to 1 indicates a significant positive correlation, which means that when one variable
              grows, so does the other.</p>
          </li>
          <li>
            <p>A coefficient around -1 indicates a significant negative correlation, implying that when one variable
              grows, the other tends to decrease.</p>
          </li>
          <li>
            <p>A coefficient around zero indicates little or no linear association between the variables.</p>
            <p>Thus, “Age” and “Person.ID” exhibit a substantial negative connection, which is uncommon and may imply
              that “Person.ID” is quantitatively linked to age. However, an ID should not have any association with age
              unless it is arbitrarily assigned based on age. “Quality of Sleep” and “Physical Activity Level” show a
              significant positive link, implying that persons who engage in more physical exercise may have better
              sleep quality. “Stress Level” appears to have a modest positive connection with “Systolic Pressure” and
              “Diastolic Pressure,” showing that more stress may be connected with greater blood pressure. “Daily Steps”
              has a substantial negative association with “Heart Rate,” implying that those who take more daily steps
              may have a lower resting heart rate, which is an indication of excellent cardiovascular health.<br>
            </p>
          </li>
        </ul>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb55">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Sleep Duration vs Quality of Sleep</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Quality.of.Sleep, <span class="at">y =</span> Sleep.Duration)) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Long Rest = Good Rest"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Quality of Sleep"</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sleep Duration (hours)"</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Stress Level vs Quality of Sleep</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Quality.of.Sleep, <span class="at">y =</span> Stress.Level)) <span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"More Stress = Bad Rest"</span>,</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Quality of Sleep"</span>,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Stress Level"</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the plots</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>plot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb57">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>plot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Long Rest = Good Rest</strong>:</p>
        <p>The first figure demonstrates a favorable relationship between sleep length and sleep quality. Sleep duration
          increases as sleep quality scores rise, implying that those who report higher sleep quality sleep for longer
          periods of time. The data points are densely packed around the trend line, particularly when sleep quality
          improves, demonstrating a significant correlation between these two factors.<br>
        </p>
        <p><strong>More Stress = Bad Rest</strong>:</p>
        <p>The second figure demonstrates a negative link between stress and sleep quality. As stress levels rise, the
          quality of sleep declines, implying that increased stress is linked to decreased sleep quality. The trend line
          slopes lower across the plot, and the data points, albeit slightly dispersed, follow the downward trend,
          confirming the negative link between stress and sleep quality.<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb59">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Physical Activity Level vs Sleep Quality</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Quality.of.Sleep, <span class="at">y =</span> Physical.Activity.Level)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"A: Sleep quality based on physical activity"</span>,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sleep Quality"</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Physical Activity Level (minutes)"</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Age vs Sleep Duration</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Sleep.Duration)) <span class="sc">+</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"B: The older you get, the more you sleep"</span>,</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sleep Duration (hours)"</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Heart Rate vs Sleep Duration</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>plot5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Heart.Rate, <span class="at">y =</span> Sleep.Duration)) <span class="sc">+</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"C: Quickest Heartbeat, Fewest Sleep"</span>,</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Heart Rate"</span>,</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sleep Duration (hours)"</span>)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Physical Activity vs Sleep Duration</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>plot6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Physical.Activity.Level, <span class="at">y =</span> Sleep.Duration)) <span class="sc">+</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"D: Engaging in physical exercise can facilitate sleep"</span>,</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Physical Activity"</span>,</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sleep Duration (hours)"</span>)</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the plots</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>plot3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb61">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>plot4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb63">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>plot5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-16-3.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb65">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>plot6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-16-4.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Sleep Quality Based on Physical Activity</strong>:</p>
        <p>There appears to be a favorable relationship between physical exercise (in minutes) and sleep quality. The
          sleep quality score improves with increased physical activity. The shaded region reflects the confidence
          interval, which indicates some uncertainty around the trend line but overall suggests that more physical
          activity is connected with higher sleep quality.<br>
        </p>
        <p><strong>Sleep Duration and Age</strong>:</p>
        <p>The graph shows a positive link between age and sleep length (in hours). Sleep duration rises with age,
          suggesting that older people sleep more rather than less. However, the distribution of data points indicates
          that there is significant variability and that other factors may possibly play a role.<br>
        </p>
        <p><strong>Sleep Duration and Heart Rate</strong>:</p>
        <p>This graph indicates a negative association between heart rate and sleep duration. It suggests that a greater
          resting heart rate leads to shorter sleep lengths. The trend line falls as the heart rate rises, corroborating
          this theory.<br>
        </p>
        <p><strong>Sleep Duration and Physical Activity</strong>:</p>
        <p>This plot demonstrates a beneficial relationship between physical activity and sleep length. As physical
          activity increases, so does sleep length, supporting the title’s claim that physical exercise can help you
          sleep longer.<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb67">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Heartbeat vs Stress Lvevel</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>plot7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Heart.Rate, <span class="at">y =</span> Stress.Level)) <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"A: Increased stress leads to quicker heartbeats"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Heartbeat"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Stress Level"</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Heartbeat vs Quality of Sleep</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>plot8 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Heart.Rate, <span class="at">y =</span> Quality.of.Sleep)) <span class="sc">+</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"B: Faster pulse, worse quality of sleep"</span>,</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Heartbeat"</span>,</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Quality of Sleep"</span>)</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the plots</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>plot7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb69">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>plot8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Increased stress leads to quicker heartbeats</strong>:</p>
        <p>This scatter plot with a regression line demonstrates a positive link between heart rate and stress level. As
          the heart rate increases, so does the stress level. The shaded region surrounding the regression line
          represents the prediction’s confidence interval, indicating that while there is some uncertainty in the
          connection, the overall trend is positive.<br>
        </p>
        <p><strong>Faster pulse, worse quality of sleep</strong>:</p>
        <p>This scatter figure, which includes a regression line, shows a negative link between heart rate and sleep
          quality. As the heart rate rises, the quality of sleep appears to deteriorate. The confidence interval is
          likewise shaded, indicating variability while maintaining an overall decreasing trend.<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb71">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Physical Activity based on Sleep Quality</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>plot9 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Physical.Activity.Level, <span class="at">y =</span> Quality.of.Sleep)) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"A: Physical Activity based on Sleep Quality"</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Physical Activity"</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sleep Quality"</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Sleep Duration based on Sleep Quality</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>plot10 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Sleep.Duration, <span class="at">y =</span> Quality.of.Sleep)) <span class="sc">+</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"B: Sleep Duration based on Sleep Quality"</span>,</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sleep Duration"</span>,</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Quality of Sleep"</span>)</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the plots</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>plot9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb73">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>plot10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Sleep Quality based on Physical Activity:</strong></p>
        <p>This scatter plot demonstrates a favorable correlation between physical exercise and sleep quality. As
          physical activity levels rise, sleep quality appears to improve lightly.</p>
        <p><strong>Sleep Quality based on Heartbeat:</strong></p>
        <p>This graph illustrates a positive correlation between sleep duration and sleep quality.</p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb75">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Stress Level based on Physical Activity</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>plot11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Physical.Activity.Level , <span class="at">y =</span> Stress.Level)) <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Physical Activity Level based on Stress Level"</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Physical Activity Level"</span>,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Stress Level"</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the plot</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>plot11</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stderr">
            <pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Stress Level based on Physical Activity:</strong></p>
        <p>This scatter plot depicts the association between physical activity (x-axis) and stress level (y-axis).<br>
        </p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb77">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Sleep Duration vs Age with BMI categories</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Sleep.Duration, <span class="at">color =</span> BMI.Category)) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sleep Duration vs Age with BMI categories"</span>) <span class="sc">+</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p1, <span class="at">type =</span> <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb78">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Quality of Sleep vs Age with BMI categories</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Quality.of.Sleep, <span class="at">color =</span> BMI.Category)) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Quality of Sleep vs Age with BMI categories"</span>) <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p2, <span class="at">type =</span> <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb79">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Quality of Sleep vs HeartRate with Sleep Disorder categories</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Heart.Rate, <span class="at">y =</span> Quality.of.Sleep, <span class="at">color =</span> Sleep.Disorder)) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Quality of Sleep vs Heart Rate with Sleep Disorder"</span>) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p3, <span class="at">type =</span> <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb80">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Quality of Sleep vs Stress Level with Sleep Disorder categories</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Stress.Level, <span class="at">y =</span> Quality.of.Sleep, <span class="at">color =</span> Sleep.Disorder)) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sleep vs Stress Level with Sleep Disorder"</span>) <span class="sc">+</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p4, <span class="at">type =</span> <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb81">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Quality of Sleep vs Blood Preassure</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Heart.Rate, <span class="at">y =</span> Quality.of.Sleep, <span class="at">color =</span> Blood.Pressure.Category)) <span class="sc">+</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Heartbeat vs Blood Pressure"</span>) <span class="sc">+</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p5, <span class="at">type =</span> <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
          </div>
        </div>
      </section>
      <section id="machine-learning" class="level2">
        <h2 class="anchored" data-anchor-id="machine-learning">Machine Learning</h2>
        <p><strong>Linear Regression</strong></p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb82">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Response and predictor variables</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> data<span class="sc">$</span>Quality.of.Sleep</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(Sleep.Duration, Age, Physical.Activity.Level, Stress.Level, Heart.Rate, Daily.Steps)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a constant column for the intercept</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Intercept =</span> <span class="dv">1</span>, X)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets (70% train, 30% test)</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(y, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> <span class="fu">subset</span>(X, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> <span class="fu">subset</span>(X, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> <span class="fu">subset</span>(y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> <span class="fu">subset</span>(y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the OLS model to the training data</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">as.data.frame</span>(X_train))</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>
Call:
lm(formula = y_train ~ ., data = as.data.frame(X_train))

Residuals:
    Min      1Q  Median      3Q     Max 
-1.0422 -0.2033  0.0057  0.2423  1.1027 

Coefficients: (1 not defined because of singularities)
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              5.332e+00  8.071e-01   6.606 2.27e-10 ***
Intercept                       NA         NA      NA       NA    
Sleep.Duration           6.730e-01  4.888e-02  13.768  &lt; 2e-16 ***
Age                      1.532e-02  2.848e-03   5.378 1.70e-07 ***
Physical.Activity.Level -4.056e-05  2.352e-03  -0.017 0.986257    
Stress.Level            -2.945e-01  2.979e-02  -9.886  &lt; 2e-16 ***
Heart.Rate              -3.586e-02  1.013e-02  -3.540 0.000476 ***
Daily.Steps              9.029e-05  3.063e-05   2.947 0.003500 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3555 on 256 degrees of freedom
Multiple R-squared:  0.9152,    Adjusted R-squared:  0.9133 
F-statistic: 460.8 on 6 and 256 DF,  p-value: &lt; 2.2e-16</code></pre>
          </div>
        </div>
        <p><strong>Interpretation of Model Summary</strong>:</p>
        <p>Output indicates that the predictors Sleep Duration, Age, Stress Level, Heart Rate, and Daily Steps are
          significant, while Physical Activity Level is not. The model’s high R-squared (0.9152) and Adjusted R-squared
          (0.9133) values indicate a strong fit.<br>
        </p>
        <div class="cell">

        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb84">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove Physical Activity Level from the predictors</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(Age, Sleep.Duration, Stress.Level, Heart.Rate, Daily.Steps)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Intercept =</span> <span class="dv">1</span>, X)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets (70% train, 30% test)</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(y, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> <span class="fu">subset</span>(X, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> <span class="fu">subset</span>(X, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> <span class="fu">subset</span>(y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> <span class="fu">subset</span>(y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the new OLS model to the training data</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>model_refined <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">as.data.frame</span>(X_train))</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_refined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>
Call:
lm(formula = y_train ~ ., data = as.data.frame(X_train))

Residuals:
     Min       1Q   Median       3Q      Max 
-1.04221 -0.20251  0.00561  0.24238  1.10248 

Coefficients: (1 not defined because of singularities)
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     5.341e+00  6.203e-01   8.609 7.48e-16 ***
Intercept              NA         NA      NA       NA    
Age             1.531e-02  2.840e-03   5.393 1.57e-07 ***
Sleep.Duration  6.728e-01  4.680e-02  14.375  &lt; 2e-16 ***
Stress.Level   -2.943e-01  2.798e-02 -10.519  &lt; 2e-16 ***
Heart.Rate     -3.596e-02  8.131e-03  -4.423 1.44e-05 ***
Daily.Steps     8.983e-05  1.493e-05   6.015 6.15e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3548 on 257 degrees of freedom
Multiple R-squared:  0.9152,    Adjusted R-squared:  0.9136 
F-statistic: 555.1 on 5 and 257 DF,  p-value: &lt; 2.2e-16</code></pre>
          </div>
        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb86">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define MAE function</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="cf">function</span>(y, pred) {</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(y <span class="sc">-</span> pred)), <span class="dv">2</span>))</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions on training data with refined model</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>pred_train_refined <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_refined, <span class="at">newdata =</span> <span class="fu">as.data.frame</span>(X_train))</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co"># MAE for training data with refined model</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>naive_mae_train <span class="ot">&lt;-</span> <span class="fu">mae</span>(y_train, <span class="fu">mean</span>(y_train))</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>model_mae_train_refined <span class="ot">&lt;-</span> <span class="fu">mae</span>(y_train, pred_train_refined)</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Naïve Training MAE:'</span>, naive_mae_train))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>[1] "Naïve Training MAE: 1.05"</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb88">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Training MAE with refined model:'</span>, model_mae_train_refined))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>[1] "Training MAE with refined model: 0.27"</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb90">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting distribution of errors for refined model</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">error =</span> y_train <span class="sc">-</span> pred_train_refined), <span class="fu">aes</span>(<span class="at">x =</span> error)) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of errors (train) with refined model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb91">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">abs_error =</span> <span class="fu">abs</span>(y_train <span class="sc">-</span> pred_train_refined)), <span class="fu">aes</span>(<span class="at">x =</span> abs_error)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of absolute errors (train) with refined model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb92">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions on test data with refined model</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>pred_test_refined <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_refined, <span class="at">newdata =</span> <span class="fu">as.data.frame</span>(X_test))</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># MAE for test data with refined model</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>naive_mae_test <span class="ot">&lt;-</span> <span class="fu">mae</span>(y_test, <span class="fu">mean</span>(y_test))</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>model_mae_test_refined <span class="ot">&lt;-</span> <span class="fu">mae</span>(y_test, pred_test_refined)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Naïve Testing MAE:'</span>, naive_mae_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>[1] "Naïve Testing MAE: 1.03"</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb94">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Testing MAE with refined model:'</span>, model_mae_test_refined))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>[1] "Testing MAE with refined model: 0.31"</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb96">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting distribution of errors for refined model</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">error =</span> y_test <span class="sc">-</span> pred_test_refined), <span class="fu">aes</span>(<span class="at">x =</span> error)) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of errors (test) with refined model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb97">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">abs_error =</span> <span class="fu">abs</span>(y_test <span class="sc">-</span> pred_test_refined)), <span class="fu">aes</span>(<span class="at">x =</span> abs_error)) <span class="sc">+</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of absolute errors (test) with refined model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-28-4.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Improved Model</strong> :</p>
        <p>By removing an insignificant predictor (Physical.Activity.Level), multicollinearity issues are likely
          reduced, resulting in more reliable estimates of the coefficients. The refined model maintains a high
          R-squared (0.9152) and Adjusted R-squared (0.9136), indicating that the model still explains a significant
          portion of the variance in the response variable. The F-statistic is very high and significant, suggesting
          that the overall model is a good fit.<br>
        </p>
        <p><strong>Mean Absolute Error</strong> :</p>
        <p>The Training MAE for the refined model (0.27) is much lower than the Naïve Training MAE (1.05), indicating
          that the model fits the training data well. The Testing MAE for the refined model (0.31) is also lower than
          the Naïve Testing MAE (1.03), showing good predictive performance on the test data. The similarity between
          Training MAE (0.27) and Testing MAE (0.31) suggests that the model does not overfit the training data and
          generalizes well to unseen data. .<br>
        </p>
        <p><strong>Gradient Boosting Machine</strong> In this part of the project, we implemented a Gradient Boosting
          Machine (GBM) model to predict the quality of sleep based on various factors such as sleep duration, age,
          physical activity level, stress level, heart rate, and daily steps. We began by defining a grid of
          hyperparameters to tune the model, including the number of trees, interaction depth, shrinkage (learning
          rate), and minimum observations in the terminal nodes. We set up a 5-fold cross-validation to robustly
          evaluate the model’s performance and prevent overfitting. The data was split into training (70%) and testing
          (30%) sets, and the GBM model was trained using the defined hyperparameters and cross-validation settings.</p>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb98">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the data into training (70%) and testing (30%) sets</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">455</span>) </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span>, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> data[trainIndex, ]</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> data[<span class="sc">-</span>trainIndex, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb99">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the hyperparameter grid</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.trees =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>),       <span class="co"># Number of trees</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">interaction.depth =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),     <span class="co"># Depth of each tree</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">shrinkage =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>),  <span class="co"># Learning rate</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.minobsinnode =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>)        <span class="co"># Minimum number of observations in the terminal nodes</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting up the training control with 5-fold cross-validation</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb100">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training the model using the grid search</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">455</span>) <span class="co"># For reproducibility</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>gbm_tuned <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Sleep.Duration</span><span class="st">`</span> <span class="sc">+</span> Age <span class="sc">+</span> <span class="st">`</span><span class="at">Physical.Activity.Level</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Stress.Level</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Heart.Rate</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Daily.Steps</span><span class="st">`</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> trainData,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"gbm"</span>,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> train_control,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneGrid =</span> grid,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
        </div>
        <div class="cell">
          <div class="sourceCode cell-code" id="cb101">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions on training data with gbm_tuned model</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>pred_train_gbm_tuned <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbm_tuned, <span class="at">newdata =</span> trainData)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="cf">function</span>(y, pred) {</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(y <span class="sc">-</span> pred)), <span class="dv">2</span>))</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co"># MAE for training data with gbm_tuned model</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>naive_mae_train <span class="ot">&lt;-</span> <span class="fu">mae</span>(trainData<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span>, <span class="fu">mean</span>(trainData<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span>))</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>model_mae_train_gbm_tuned <span class="ot">&lt;-</span> <span class="fu">mae</span>(trainData<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span>, pred_train_gbm_tuned)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Naive Training MAE:'</span>, naive_mae_train))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>[1] "Naive Training MAE: 1.03"</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb103">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Training MAE with gbm_tuned model:'</span>, model_mae_train_gbm_tuned))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>[1] "Training MAE with gbm_tuned model: 0.08"</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb105">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting distribution of errors for gbm_tuned model on training data</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">error =</span> trainData<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span> <span class="sc">-</span> pred_train_gbm_tuned), <span class="fu">aes</span>(<span class="at">x =</span> error)) <span class="sc">+</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of errors (train) with gbm_tuned model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb106">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">abs_error =</span> <span class="fu">abs</span>(trainData<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span> <span class="sc">-</span> pred_train_gbm_tuned)), <span class="fu">aes</span>(<span class="at">x =</span> abs_error)) <span class="sc">+</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of absolute errors (train) with gbm_tuned model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb107">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions on test data with gbm_tuned model</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>pred_test_gbm_tuned <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbm_tuned, <span class="at">newdata =</span> testData)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># MAE for test data with gbm_tuned model</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>naive_mae_test <span class="ot">&lt;-</span> <span class="fu">mae</span>(testData<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span>, <span class="fu">mean</span>(testData<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span>))</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>model_mae_test_gbm_tuned <span class="ot">&lt;-</span> <span class="fu">mae</span>(testData<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span>, pred_test_gbm_tuned)</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Naive Testing MAE:'</span>, naive_mae_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>[1] "Naive Testing MAE: 1.08"</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb109">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Testing MAE with gbm_tuned model:'</span>, model_mae_test_gbm_tuned))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output cell-output-stdout">
            <pre><code>[1] "Testing MAE with gbm_tuned model: 0.11"</code></pre>
          </div>
          <div class="sourceCode cell-code" id="cb111">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting distribution of errors for gbm_tuned model on test data</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">error =</span> testData<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span> <span class="sc">-</span> pred_test_gbm_tuned), <span class="fu">aes</span>(<span class="at">x =</span> error)) <span class="sc">+</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of errors (test) with gbm_tuned model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid" width="672"></p>
          </div>
          <div class="sourceCode cell-code" id="cb112">
            <pre
              class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">abs_error =</span> <span class="fu">abs</span>(testData<span class="sc">$</span><span class="st">`</span><span class="at">Quality.of.Sleep</span><span class="st">`</span> <span class="sc">-</span> pred_test_gbm_tuned)), <span class="fu">aes</span>(<span class="at">x =</span> abs_error)) <span class="sc">+</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">'blue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of absolute errors (test) with gbm_tuned model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
          </div>
          <div class="cell-output-display">
            <p><img src="SleepDisorder_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid" width="672"></p>
          </div>
        </div>
        <p><strong>Summary of Gradient Boosting Machine</strong> The naive MAE represents the error when predicting the
          mean value of the quality of sleep for all instances, serving as a baseline for comparison. The substantial
          reduction in MAE from the naive model (1.08) to the tuned GBM model (0.11) on the testing set indicates a
          significant improvement in predictive accuracy. Similarly, the training MAE for the GBM model (0.08) is much
          lower than the naive training MAE (1.03), demonstrating that the model effectively learned the patterns in the
          training data. These results suggest that the GBM model is well-tuned and capable of making accurate
          predictions, with minimal error, on both the training and testing datasets.</p>
        <p><br>
        </p>
        <p><br>
        </p>
      </section>
      <section id="references" class="level2">
        <h2 class="anchored" data-anchor-id="references">References</h2>
        <ul>
          <li>
            <p>
              https://www.psychiatry.org/patients-families/sleep-disorders/what-are-sleep-disorders#:~:text=Sleep%20disorders%20(or%20sleep%2Dwake,distress%20and%20impairment%20in%20functioning.
            </p>
          </li>
          <li>
            <p>
              https://www.mayoclinic.org/diseases-conditions/insomnia/symptoms-causes/syc-20355167#:~:text=Insomnia%20is%20a%20common%20sleep,level%20and%20affect%20your%20mood.
            </p>
          </li>
          <li>
            <p>https://my.clevelandclinic.org/health/diseases/8718-sleep-apnea</p>
          </li>
          <li>
            <p>https://www.kaggle.com/code/alessandrogiacometti/sleep-health-analysis-how-to-sleep-better</p>
          </li>
          <li>
            <p>
              https://www.salute.gov.it/portale/alleanzaCardioCerebrovascolari/dettaglioSchedeAlleanzaCardioCerebrovascolari.jsp?l
              ingua=italiano&amp;id=18&amp;area=Alleanza%20italiana%20per%20le%20malattie%20cardio-cerebrovascolari&amp;menu=malattie#:~:text=Quando%20i%20valori%20pressori%20di,si%20parla%20di%20ipertensione%20arteriosa.
            </p>
          </li>
        </ul>
      </section>
      <section id="section" class="level2">
        <h2 class="anchored" data-anchor-id="section"></h2>
      </section>

    </main>
    <!-- /main column -->
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const toggleBodyColorMode = (bsSheetEl) => {
          const mode = bsSheetEl.getAttribute("data-mode");
          const bodyEl = window.document.querySelector("body");
          if (mode === "dark") {
            bodyEl.classList.add("quarto-dark");
            bodyEl.classList.remove("quarto-light");
          } else {
            bodyEl.classList.add("quarto-light");
            bodyEl.classList.remove("quarto-dark");
          }
        }
        const toggleBodyColorPrimary = () => {
          const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
          if (bsSheetEl) {
            toggleBodyColorMode(bsSheetEl);
          }
        }
        toggleBodyColorPrimary();
        const icon = "";
        const anchorJS = new window.AnchorJS();
        anchorJS.options = {
          placement: 'right',
          icon: icon
        };
        anchorJS.add('.anchored');
        const clipboard = new window.ClipboardJS('.code-copy-button', {
          target: function (trigger) {
            return trigger.previousElementSibling;
          }
        });
        clipboard.on('success', function (e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          setTimeout(function () {
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        });
        function tippyHover(el, contentFn) {
          const config = {
            allowHTML: true,
            content: contentFn,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function (el) {
              return el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'bottom-start'
          };
          window.tippy(el, config);
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i = 0; i < noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function () {
            let href = ref.getAttribute('href');
            try { href = new URL(href).hash; } catch { }
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            return note.innerHTML;
          });
        }
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i = 0; i < bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const cites = ref.parentNode.getAttribute('data-cites').split(' ');
          tippyHover(ref, function () {
            var popup = window.document.createElement('div');
            cites.forEach(function (cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      });
    </script>
  </div> <!-- /content -->



</body>

</html>